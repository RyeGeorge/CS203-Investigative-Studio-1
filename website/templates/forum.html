{% extends 'base.html' %}  {% block title %}Forum{% endblock %}

{% block content %}  
 <body>

  <h1 align="center">Forum</h1>  
  <button id="scrollButton" class="btn btn-link">Create a Post</button>
  <ul class="list-group list-group-flush" id="posts">
    {% for post in posts %}
    <li class="list-group-item">
      <div class="row">
        <div class="col-md-9">
          <h5>{{ post.title }}</h5>
          <small>  - written by {{ post.user_name }}</small>
        </div>
        <div class="col-md-3">
          <small>{{ post.created }}</small>
        </div>
      </div>
    </li>
    <li class="list-group-item">
      {{ post.content }}
    </li>
    <li class="list-group-item">
      <h6 align="center">Comments</h6>
        <ul class="list-group list-group-flush" id="comments">
          {% for comment in post.comments %}
            <div class="row">
              <div class="col-md-4"></div>
              <li class="col-md-5">
                <small>{{ comment.user_name }}: {{ comment.content }}</small>
              </li>
            </div>
          {% endfor %}
        </ul>
    </li>

    <div align="center">
      <button id="toggleButton" class="btn btn-secondary toggleButton">Comment</button>
      <div id="textAreaContainer" style="display: none;">
        <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-6">
              <form method="POST" action="{{ url_for('views.create_comment', post_id=post.id) }}">
                <textarea name="comment" id="comment" rows="3" class="form-control textAreaContainer"></textarea>
                <button type="submit" name="submit_button" value="comment_btn" class="btn-sm">Submit</button>
              </form>
            </div>
        </div>
      </div>
    </div>
    <br />
    {% endfor %} 
  </ul>
  <br />
  <h3 id="targetHeading" align="center">Create a Post</h3>
  <form method="POST">
    <textarea placeholder="Title" name="title" id="title" class="form-control"></textarea>
    <textarea placeholder="Post content" name="post" id="post" class="form-control"></textarea>
    <br />
    <div align="center">
      <button type="submit" name="submit_button" value="post_btn" class="btn btn-primary">Add Post</button>
    </div>
  </form>


<!--  <div>
    <h1>Forum</h1>

    <form method="POST" action="{{ url_for('views.forum') }}">
        <h2>Create a new post</h2>
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" required><br><br>
        <label for="content">Content:</label><br>
        <textarea id="content" name="content" rows="4" cols="50" required></textarea><br><br>
        <input type="submit" value="Create Post">
    </form>

    <h2>All Posts</h2>
    {% for post in posts %}
        <div>
            <h3>{{ post.title }}</h3>
            <p>{{ post.created}}</p>
            <p>{{ post.content }}</p>
            <p>{{ post.user_id}}</p>
            <p>{{ post.id}}</p>

        </div>
    {% endfor %}
  </div>-->

  <script>
    //function to scroll to heading on button click 
    document.getElementById("scrollButton").addEventListener("click", function() {
      var targetHeading = document.getElementById("targetHeading");
      targetHeading.scrollIntoView({ behavior: "smooth" });
    });
  </script>

  <!--<script>
    //function to toggle text area visibility
    document.addEventListener('DOMContentLoaded', function() {
      var toggleButton = document.getElementById('toggleButton');
      var textAreaContainer = document.getElementById('textAreaContainer');
      
      toggleButton.addEventListener('click', function() {
        if (textAreaContainer.style.display === 'none') {
          textAreaContainer.style.display = 'block';
        } else {
          textAreaContainer.style.display = 'none';
        }
      });
    });
  </script>-->
  
  <script>
    // Function to toggle the textarea for each button
    document.addEventListener("DOMContentLoaded", function() {
      const toggleButtons = document.querySelectorAll(".toggleButton");
      toggleButtons.forEach(function(button) {
        button.addEventListener("click", function() {
          const textArea = button.nextElementSibling;
          textArea.style.display = (textArea.style.display === "none") ? "block" : "none";
        });
      });
    });
  </script>

</body>
{% endblock %} 
